<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>`presize` • presize</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="`presize`">
<meta property="og:description" content="presize">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">presize</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/presize.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/CTU-Bern/presize/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="presize_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip><code>presize</code></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/CTU-Bern/presize/blob/HEAD/vignettes/presize.Rmd" class="external-link"><code>vignettes/presize.Rmd</code></a></small>
      <div class="hidden name"><code>presize.Rmd</code></div>

    </div>

    
    
<p><a href="https://www.bmj.com/content/339/bmj.b3985" class="external-link">Bland (2009)</a> recommended to base study sizes on the width of the confidence interval rather the power of a statistical test. The goal of <code>presize</code> is to provide functions for such precision based sample size calculations. For a given sample size, the functions will return the precision (width of the confidence interval), and vice versa.</p>
<p><code>presize</code> is loaded like any other R Package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/CTU-Bern/presize" class="external-link">presize</a></span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="using-presize">Using <code>presize</code><a class="anchor" aria-label="anchor" href="#using-presize"></a>
</h2>
<p>Here we present a couple of examples of using <code>presize</code> to determine the suitable sample size for a trial.</p>
<div class="section level3">
<h3 id="precision-with-a-fixed-n">Precision with a fixed N<a class="anchor" aria-label="anchor" href="#precision-with-a-fixed-n"></a>
</h3>
<p>As preparation for a trial to estimate the sensitivity and specificity of a mobile colposcope, a device for detecting tissue abnormality, a sample size calculation was made to estimate the precision of the sensitivity of the device. A best guess for sensitivity was 75% at a prevalence of 15% with a desired sample size of 250 participants. As such, the question to be answered is how wide is the confidence interval going to be under such a scenario?</p>
<p>We plug the values into the <code>prec_sens</code> (precision of sensitivity) function as follows</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sensspec.html">prec_sens</a></span><span class="op">(</span>sens   <span class="op">=</span> <span class="fl">.75</span>,  <span class="co"># sensitivity </span>
                 prev   <span class="op">=</span> <span class="fl">.15</span>,  <span class="co"># prevalence</span>
                 ntot   <span class="op">=</span> <span class="fl">250</span>,  <span class="co"># sample size</span>
                 method <span class="op">=</span> <span class="st">"wilson"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; estimating n from 'ntot' and 'prev'</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      precision for a sensitivity with Wilson confidence interval. </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   sens   sensadj  n prev ntot conf.width conf.level       lwr       upr</span>
<span class="co">#&gt; 1 0.75 0.7270475 38 0.15  250  0.2663919       0.95 0.5938516 0.8602435</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; NOTE: sensadj is the adjusted sensitivity, from which the ci is calculated.</span></code></pre></div>
<p>We see that with 250 participants, the confidence interval would be from 59% (<code>lwr</code>) to 86% (<code>upr</code>).</p>
<p>Note that Wilson’s method of calculating confidence intervals adjusts the point estimate to allow the calculation of a symmetrical CI. This is the <code>sensadj</code> variable. For some measures there are multiple methods available. In the case of <code>prec_sens</code> (as well as <code>prec_spec</code> and <code>prec_prop</code>), there are four different approaches for creating confidence intervals, each yielding slightly different results.</p>
<p>For specificity, we use the <code>prec_spec</code> function instead. For demonstration purposes, we can also change the method used to calculate the CI.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/sensspec.html">prec_spec</a></span><span class="op">(</span>spec   <span class="op">=</span> <span class="fl">.75</span>,  <span class="co"># specificity </span>
          prev   <span class="op">=</span> <span class="fl">.15</span>,  <span class="co"># prevalence</span>
          ntot   <span class="op">=</span> <span class="fl">250</span>,  <span class="co"># sample size</span>
          method <span class="op">=</span> <span class="st">"exact"</span><span class="op">)</span>
<span class="co">#&gt; estimating n from 'ntot' and 'prev'</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      precision for a specificity with exact confidence interval. </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   spec specadj   n prev ntot conf.width conf.level       lwr      upr</span>
<span class="co">#&gt; 1 0.75      NA 213 0.15  250  0.1203922       0.95 0.6862538 0.806646</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; NOTE: specadj is the adjusted specificity, from which the ci is calculated.</span></code></pre></div>
<p>Using the other functions in <code>presize</code> is the same. For instance the precision of a mean of 60 with an SD of 10 and 40 observations is calculated as follows.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/prec_mean.html">prec_mean</a></span><span class="op">(</span><span class="fl">60</span>, sd <span class="op">=</span> <span class="fl">10</span>, n <span class="op">=</span> <span class="fl">40</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      precision for mean </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   mean sd  n conf.width conf.level      lwr      upr</span>
<span class="co">#&gt; 1   60 10 40    6.39631       0.95 56.80184 63.19816</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="n-for-a-fixed-precision">N for a fixed precision<a class="anchor" aria-label="anchor" href="#n-for-a-fixed-precision"></a>
</h3>
<p>While fixing the sample size is sometimes necessary, it is more common to select a sample size based on a given precision. We might want to achieve a sensitivity of a given amount (e.g. plus-minus 5%). This is also possible with <code>presize</code>. Using the same code as above, we replace the <code>ntot</code> argument with the <code>conf.width</code> argument.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sensspec.html">prec_sens</a></span><span class="op">(</span>sens       <span class="op">=</span> <span class="fl">.75</span>,   <span class="co"># sensitivity </span>
                 prev       <span class="op">=</span> <span class="fl">.15</span>,   <span class="co"># prevalence</span>
                 conf.width <span class="op">=</span> <span class="fl">.1</span>,    <span class="co"># CI width</span>
                 method     <span class="op">=</span> <span class="st">"wilson"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      sample size for a sensitivity with Wilson confidence interval. </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   sens   sensadj        n prev     ntot conf.width conf.level       lwr</span>
<span class="co">#&gt; 1 0.75 0.7466814 285.5428 0.15 1903.619        0.1       0.95 0.6966814</span>
<span class="co">#&gt;         upr</span>
<span class="co">#&gt; 1 0.7966814</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; NOTE: sensadj is the adjusted sensitivity, from which the ci is calculated.</span></code></pre></div>
<p>Under this scenario, 1904 participants (of which approximately 286 would have the condition) will yield a CI width of 0.1 (10%), on average.</p>
<p>Most of the functions in <code>presize</code> have similar options, although the sample size argument is generally <code>n</code> instead of <code>ntot</code> (<code>prec_sens</code> and <code>prec_spec</code> are special in that you can pass either a number of individuals with a condition to be detected with <code>n</code>, or you pass <code>ntot</code> and <code>prev</code> to get the CI width for a mixed group in which case <code>n</code> is derived from <code>ntot</code> and <code>prev</code>). The calculations for sensitivity can also be preformed if the number of cases rather than the total number and prevalence are available. For instance, if we have 50 individuals with the condition and we expect a sensitivity of 60%, we can put those values in instead.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/sensspec.html">prec_sens</a></span><span class="op">(</span><span class="fl">.6</span>, n <span class="op">=</span> <span class="fl">50</span>, method <span class="op">=</span> <span class="st">"wilson"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      precision for a sensitivity with Wilson confidence interval. </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   sens   sensadj  n prev ntot conf.width conf.level       lwr       upr</span>
<span class="co">#&gt; 1  0.6 0.5928652 50   NA   NA  0.2621017       0.95 0.4618144 0.7239161</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; NOTE: sensadj is the adjusted sensitivity, from which the ci is calculated.</span></code></pre></div>
<p>Sensitivities and specificities are just proportions so <code>prec_prop</code> can also be used for this latter example.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/prec_prop.html">prec_prop</a></span><span class="op">(</span><span class="fl">.6</span>, n <span class="op">=</span> <span class="fl">50</span>, method <span class="op">=</span> <span class="st">"wilson"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      precision for a proportion with Wilson confidence interval. </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     p      padj  n conf.width conf.level       lwr       upr</span>
<span class="co">#&gt; 1 0.6 0.5928652 50  0.2621017       0.95 0.4618144 0.7239161</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; NOTE: padj is the adjusted proportion, from which the ci is calculated.</span></code></pre></div>
<p>Using the other functions in <code>presize</code> is the same. For instance, the sample size to obtain a CI width of 5 units with a mean of 60 with an SD of 10 is calculated as follows.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/prec_mean.html">prec_mean</a></span><span class="op">(</span><span class="fl">60</span>, sd <span class="op">=</span> <span class="fl">10</span>, conf.width <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      sample size for mean </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   mean sd       n conf.width conf.level  lwr  upr</span>
<span class="co">#&gt; 1   60 10 63.8979          5       0.95 57.5 62.5</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="multiple-scenarios">Multiple scenarios<a class="anchor" aria-label="anchor" href="#multiple-scenarios"></a>
</h3>
<p>It is common for only a vague idea of what to expect in terms of SDs, sensitivities, etc, so it is often worthwhile creating a set of scenarios.</p>
<p>Returning to the colposcope example from above… We want to see how the CI width varies with different sensitivities. With <code>presize</code>, it’s easy to run different scenarios, simply by passing multiple values to each parameter (where multiple values are passed, they should have the same length!). For varying a single parameter, scenarios can be created with <code>seq</code> and passed that to the appropriate <code>presize</code> functions argument. Here we vary sensitivity between 50% and 95% in steps of 5%.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">scenario_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sensspec.html">prec_sens</a></span><span class="op">(</span>sens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.95</span>, <span class="fl">.05</span><span class="op">)</span>, 
                            prev <span class="op">=</span> <span class="fl">.15</span>, 
                            ntot <span class="op">=</span> <span class="fl">250</span>, 
                            method <span class="op">=</span> <span class="st">"wilson"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; estimating n from 'ntot' and 'prev'</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      precision for a sensitivity with Wilson confidence interval. </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    sens   sensadj  n prev ntot conf.width conf.level       lwr       upr</span>
<span class="co">#&gt; 1  0.50 0.5000000 38 0.15  250  0.3030014       0.95 0.3484993 0.6515007</span>
<span class="co">#&gt; 2  0.55 0.5454095 38 0.15  250  0.3016224       0.95 0.3945983 0.6962207</span>
<span class="co">#&gt; 3  0.60 0.5908190 38 0.15  250  0.2974469       0.95 0.4420956 0.7395424</span>
<span class="co">#&gt; 4  0.65 0.6362285 38 0.15  250  0.2903543       0.95 0.4910514 0.7814056</span>
<span class="co">#&gt; 5  0.70 0.6816380 38 0.15  250  0.2801231       0.95 0.5415765 0.8216996</span>
<span class="co">#&gt; 6  0.75 0.7270475 38 0.15  250  0.2663919       0.95 0.5938516 0.8602435</span>
<span class="co">#&gt; 7  0.80 0.7724570 38 0.15  250  0.2485815       0.95 0.6481663 0.8967478</span>
<span class="co">#&gt; 8  0.85 0.8178665 38 0.15  250  0.2257283       0.95 0.7050024 0.9307307</span>
<span class="co">#&gt; 9  0.90 0.8632761 38 0.15  250  0.1960769       0.95 0.7652376 0.9613145</span>
<span class="co">#&gt; 10 0.95 0.9086856 38 0.15  250  0.1557928       0.95 0.8307891 0.9865820</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; NOTE: sensadj is the adjusted sensitivity, from which the ci is calculated.</span></code></pre></div>
<p>We can also use <code>expand.grid</code> to pass scenarios varying multiple parameters simultaneously. Below we vary sensitivity, prevalence and sample size.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>sens <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.95</span>, <span class="fl">.1</span><span class="op">)</span>,
                         prev <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.1</span>, <span class="fl">.2</span>, <span class="fl">.04</span><span class="op">)</span>,
                         ntot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">250</span>, <span class="fl">350</span><span class="op">)</span><span class="op">)</span>

<span class="op">(</span><span class="va">scenario_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sensspec.html">prec_sens</a></span><span class="op">(</span>sens <span class="op">=</span> <span class="va">scenarios</span><span class="op">$</span><span class="va">sens</span>, 
                            prev <span class="op">=</span> <span class="va">scenarios</span><span class="op">$</span><span class="va">prev</span>, 
                            ntot <span class="op">=</span> <span class="va">scenarios</span><span class="op">$</span><span class="va">ntot</span>, 
                            method <span class="op">=</span> <span class="st">"wilson"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; estimating n from 'ntot' and 'prev'</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;      precision for a sensitivity with Wilson confidence interval. </span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    sens   sensadj  n prev ntot conf.width conf.level       lwr       upr</span>
<span class="co">#&gt; 1   0.5 0.5000000 25 0.10  250  0.3649551       0.95 0.3175224 0.6824776</span>
<span class="co">#&gt; 2   0.6 0.5866808 25 0.10  250  0.3585724       0.95 0.4073946 0.7659670</span>
<span class="co">#&gt; 3   0.7 0.6733615 25 0.10  250  0.3387033       0.95 0.5040099 0.8427132</span>
<span class="co">#&gt; 4   0.8 0.7600423 25 0.10  250  0.3027037       0.95 0.6086905 0.9113942</span>
<span class="co">#&gt; 5   0.9 0.8467231 25 0.10  250  0.2435219       0.95 0.7249621 0.9684841</span>
<span class="co">#&gt; 6   0.5 0.5000000 35 0.14  250  0.3144853       0.95 0.3427574 0.6572426</span>
<span class="co">#&gt; 7   0.6 0.5901099 35 0.14  250  0.3087656       0.95 0.4357271 0.7444927</span>
<span class="co">#&gt; 8   0.7 0.6802198 35 0.14  250  0.2909327       0.95 0.5347534 0.8256862</span>
<span class="co">#&gt; 9   0.8 0.7703297 35 0.14  250  0.2584917       0.95 0.6410839 0.8995755</span>
<span class="co">#&gt; 10  0.9 0.8604396 35 0.14  250  0.2046081       0.95 0.7581356 0.9627436</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  [Output truncated at 10 of 30 rows]</span>
<span class="co">#&gt; NOTE: sensadj is the adjusted sensitivity, from which the ci is calculated.</span></code></pre></div>
<p>From the print method, we see the details of the individual scenarios. The default print method for <code>presize</code> objects only prints the first 10 rows, but there are in fact 30 rows (there is also a <code>print</code> function, with an <code>n</code> option to define how many rows to print, e.g. <code>print(scenario_data, n = 5)</code> can be used to print the first five rows).</p>
<p>Using the <code>as.data.frame</code> method, we can convert the list returned by <code>prec_sens</code> to a dataframe from which we can create tables or figures. Where multiple scenarios are calculated, plotting them can be particularly informative. <code>ggplot2</code>, for example, is particularly useful for this. Below we show CI width as a function of sensitivity, but the other parameters could be chosen instead.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">scenario_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">scenario_data</span><span class="op">)</span>

<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">scenario_df</span>, 
       <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sens</span>, 
           y <span class="op">=</span> <span class="va">conf.width</span>, 
           <span class="co"># convert colour to factor for distinct colours rather than a continuum</span>
           col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">prev</span><span class="op">)</span>, 
           group <span class="op">=</span> <span class="va">prev</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Sensitivity"</span>, y <span class="op">=</span> <span class="st">"CI width"</span>, col <span class="op">=</span> <span class="st">"Prevalence"</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">ntot</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="presize_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<p>We could also create a table of the scenarios containing the CIs. Below we select only the scenarios with sensitivities above 70% and reshape and format the table and use the <code>gt</code> package to print a nice table in HTML.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'dplyr'</span>
<span class="co">#&gt; The following objects are masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     filter, lag</span>
<span class="co">#&gt; The following objects are masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     intersect, setdiff, setequal, union</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'magrittr'</span>
<span class="co">#&gt; The following object is masked from 'package:tidyr':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     extract</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com/" class="external-link">gt</a></span><span class="op">)</span>

<span class="va">scenario_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="co"># create the values needed specifically for the table</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>
    txt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%3.1f - %3.1f"</span>, <span class="va">lwr</span> <span class="op">*</span> <span class="fl">100</span>, <span class="va">upr</span> <span class="op">*</span> <span class="fl">100</span><span class="op">)</span>,
    `Prevalence (%)` <span class="op">=</span> <span class="va">prev</span> <span class="op">*</span> <span class="fl">100</span>,
    Sensitivity <span class="op">=</span> <span class="va">sens</span> <span class="op">*</span> <span class="fl">100</span>,
    ntot <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"N = %1.0f"</span>, <span class="va">ntot</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="co"># select particular scenarios and variables to keep</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">sens</span> <span class="op">&gt;</span> <span class="fl">.7</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">ntot</span>, <span class="va">Sensitivity</span>, <span class="va">`Prevalence (%)`</span>, <span class="va">txt</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="co"># reshape</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>
    names_from <span class="op">=</span> <span class="va">Sensitivity</span>, 
    values_from <span class="op">=</span> <span class="va">txt</span>, 
    id_cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">`Prevalence (%)`</span>, <span class="va">ntot</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="co"># group by ntot to split the table a little</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">ntot</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co"># create the table</span>
  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="co"># add a header</span>
  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_spanner.html" class="external-link">tab_spanner</a></span><span class="op">(</span>
    label <span class="op">=</span> <span class="st">"Sensitivity (%)"</span>,
    columns <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span>
  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_align.html" class="external-link">cols_align</a></span><span class="op">(</span><span class="st">"center"</span>, columns <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="co"># increase the spacing between cells</span>
  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_style.html" class="external-link">tab_style</a></span><span class="op">(</span>
    style <span class="op">=</span> <span class="st">"padding-left:12px;padding-right:12px;"</span>,
    locations <span class="op">=</span> <span class="fu"><a href="https://gt.rstudio.com/reference/cells_body.html" class="external-link">cells_body</a></span><span class="op">(</span><span class="op">)</span>
  <span class="op">)</span></code></pre></div>
<div id="mlakcqiuug" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#mlakcqiuug .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#mlakcqiuug .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mlakcqiuug .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#mlakcqiuug .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#mlakcqiuug .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mlakcqiuug .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#mlakcqiuug .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#mlakcqiuug .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#mlakcqiuug .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#mlakcqiuug .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#mlakcqiuug .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#mlakcqiuug .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#mlakcqiuug .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#mlakcqiuug .gt_from_md > :first-child {
  margin-top: 0;
}

#mlakcqiuug .gt_from_md > :last-child {
  margin-bottom: 0;
}

#mlakcqiuug .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#mlakcqiuug .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#mlakcqiuug .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#mlakcqiuug .gt_row_group_first td {
  border-top-width: 2px;
}

#mlakcqiuug .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mlakcqiuug .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#mlakcqiuug .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#mlakcqiuug .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mlakcqiuug .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#mlakcqiuug .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#mlakcqiuug .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#mlakcqiuug .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#mlakcqiuug .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mlakcqiuug .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mlakcqiuug .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#mlakcqiuug .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#mlakcqiuug .gt_left {
  text-align: left;
}

#mlakcqiuug .gt_center {
  text-align: center;
}

#mlakcqiuug .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#mlakcqiuug .gt_font_normal {
  font-weight: normal;
}

#mlakcqiuug .gt_font_bold {
  font-weight: bold;
}

#mlakcqiuug .gt_font_italic {
  font-style: italic;
}

#mlakcqiuug .gt_super {
  font-size: 65%;
}

#mlakcqiuug .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#mlakcqiuug .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#mlakcqiuug .gt_slash_mark {
  font-size: 0.7em;
  line-height: 0.7em;
  vertical-align: 0.15em;
}

#mlakcqiuug .gt_fraction_numerator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: 0.45em;
}

#mlakcqiuug .gt_fraction_denominator {
  font-size: 0.6em;
  line-height: 0.6em;
  vertical-align: -0.05em;
}
</style>
<table class="table gt_table">
<thead class="gt_col_headings">
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="2" colspan="1">Prevalence (%)</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="2">
        <span class="gt_column_spanner">Sensitivity (%)</span>
      </th>
    </tr>
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">80</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">90</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<td colspan="3" class="gt_group_heading">N = 250</td>
    </tr>
<tr class="gt_row_group_first">
<td class="gt_row gt_right" style="padding-left: 12px;padding-right: 12px;">10</td>
<td class="gt_row gt_center" style="padding-left: 12px;padding-right: 12px;">60.9 - 91.1</td>
<td class="gt_row gt_center" style="padding-left: 12px;padding-right: 12px;">72.5 - 96.8</td>
</tr>
<tr>
<td class="gt_row gt_right" style="padding-left: 12px;padding-right: 12px;">14</td>
<td class="gt_row gt_center" style="padding-left: 12px;padding-right: 12px;">64.1 - 90.0</td>
<td class="gt_row gt_center" style="padding-left: 12px;padding-right: 12px;">75.8 - 96.3</td>
</tr>
<tr>
<td class="gt_row gt_right" style="padding-left: 12px;padding-right: 12px;">18</td>
<td class="gt_row gt_center" style="padding-left: 12px;padding-right: 12px;">66.2 - 89.1</td>
<td class="gt_row gt_center" style="padding-left: 12px;padding-right: 12px;">77.9 - 95.8</td>
</tr>
<tr class="gt_group_heading_row">
<td colspan="3" class="gt_group_heading">N = 350</td>
    </tr>
<tr class="gt_row_group_first">
<td class="gt_row gt_right" style="padding-left: 12px;padding-right: 12px;">10</td>
<td class="gt_row gt_center" style="padding-left: 12px;padding-right: 12px;">64.1 - 90.0</td>
<td class="gt_row gt_center" style="padding-left: 12px;padding-right: 12px;">75.8 - 96.3</td>
</tr>
<tr>
<td class="gt_row gt_right" style="padding-left: 12px;padding-right: 12px;">14</td>
<td class="gt_row gt_center" style="padding-left: 12px;padding-right: 12px;">67.0 - 88.8</td>
<td class="gt_row gt_center" style="padding-left: 12px;padding-right: 12px;">78.6 - 95.7</td>
</tr>
<tr>
<td class="gt_row gt_right" style="padding-left: 12px;padding-right: 12px;">18</td>
<td class="gt_row gt_center" style="padding-left: 12px;padding-right: 12px;">68.5 - 88.0</td>
<td class="gt_row gt_center" style="padding-left: 12px;padding-right: 12px;">80.2 - 95.3</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Armando Lenz, Alan G. Haynes, Andreas Limacher.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
